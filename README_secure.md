# 高安全标准加密货币钱包助记词生成工具

这是一个符合密码学安全要求的加密货币钱包助记词生成工具，专为高价值资产保护设计。该工具遵循BIP-39标准，使用多源熵生成高质量随机数，并提供SLIP-39分割备份支持。

## 安全特性

- **多源熵收集**：结合操作系统CSPRNG、硬件随机源、计算熵和用户输入
- **内存安全处理**：敏感数据使用后立即从内存中安全清除
- **Unicode规范化**：严格遵循BIP-39标准的NFKD规范化
- **SLIP-39分割备份**：支持Shamir秘密共享方案，防止单点故障
- **全面安全提示**：提供详细的安全建议和用户教育
- **系统安全检查**：检测运行环境的安全状态
- **离线使用支持**：推荐并支持在离线环境中使用

## 威胁模型

该工具设计时考虑了以下威胁：

1. **随机性被劫持**：使用多源熵和熵池健康检查防止
2. **助记词泄露**：提供安全使用指南，避免数字存储
3. **用户误用**：详细的安全提示和确认步骤
4. **恢复失败**：严格遵循BIP-39标准，使用Unicode规范化
5. **单点备份失败**：支持SLIP-39分割备份方案

## 安装

1. 确保已安装Python 3.7+
2. 安装依赖库：

```bash
pip install -r requirements_secure.txt
```

## 使用方法

### 基本使用

```bash
python crypto_wallet_secure.py
```

### 功能

1. **生成新的钱包助记词**
   - 支持选择助记词长度（12-24个词）
   - 支持多种语言
   - 可选密码短语(passphrase)保护
   - 提供详细安全提示

2. **验证助记词是否有效**
   - 验证BIP-39助记词的有效性
   - 可选显示对应的种子

3. **生成SLIP-39分割备份**
   - 将BIP-39助记词或种子转换为SLIP-39分享
   - 支持多组和阈值设置
   - 可选额外密码保护

4. **恢复SLIP-39分割备份**
   - 从SLIP-39分享恢复原始种子

5. **检查系统安全状态**
   - 检测运行环境的安全性
   - 提供安全建议

## 安全建议

### 生成助记词

- 在离线环境中生成重要钱包的助记词
- 使用24个词(256位熵)获得最高安全性
- 确保环境无摄像头、无屏幕录制、无恶意软件

### 保存助记词

- 永远不要将助记词存储在数字设备上（电脑、手机、云端）
- 将助记词写在纸上或金属板上（防火、防水）
- 存放在安全的物理位置，如保险箱
- 考虑使用SLIP-39分割备份，分散存储在不同安全位置

### 使用密码短语

- 密码短语(passphrase)是BIP-39的可选"第25个词"
- 增加了安全性，但也增加了丢失风险
- 如果忘记密码短语，即使有助记词也无法恢复资产
- 密码短语应当单独保存，与助记词分开存放

### SLIP-39分割备份

- SLIP-39允许将助记词分割成多个部分，需要达到阈值数量才能恢复
- 可以设置多个组，每组有多个成员和阈值
- 增强了安全性和可靠性，防止单点故障
- 每个分享应当分开存放在不同的安全位置

## 技术细节

### BIP-39实现

该工具严格遵循BIP-39标准：
- 使用128-256位熵生成12-24个助记词
- 计算SHA-256校验和并添加到熵中
- 将熵分割为11位段并映射到词表
- 使用PBKDF2-HMAC-SHA512(2048次迭代)生成种子

### 熵收集

工具从多个来源收集熵：
- 操作系统CSPRNG (os.urandom)
- Python的secrets模块
- 硬件随机源（如果可用）
- 计算熵（RSA密钥生成）
- 用户输入熵（可选）

### 内存安全

- 敏感数据使用后立即从内存中清除
- 使用ctypes.memset覆盖字节数据
- 删除对敏感对象的引用

## 参考资料

- [BIP-0039规范](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)
- [SLIP-0039规范](https://github.com/satoshilabs/slips/blob/master/slip-0039.md)
- [NIST SP 800-90A](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf)

## 贡献与审计

该工具设计用于高安全性场景，欢迎安全专家审计代码并提出改进建议。在生产环境中使用前，建议进行独立的安全审计。