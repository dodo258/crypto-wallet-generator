# 加密货币钱包助记词生成工具

这是一个安全的加密货币钱包助记词生成工具，遵循BIP-39标准，使用多源熵生成高质量随机数，并提供多种安全特性。

## 隐私与安全声明

**重要声明：本程序不会上传、保存或记录任何生成的助记词或私钥信息。**

- 所有操作均在本地设备上完成，不涉及任何网络传输
- 不会将助记词、种子或私钥保存到磁盘或云端
- 不会收集任何用户数据或使用情况统计信息
- 程序代码完全开源，可供审计和验证

## 项目概述

本项目提供了两个版本的钱包助记词生成工具：

1. **基础版本** (`crypto_wallet_generator.py`) - 基本的BIP-39助记词生成功能（建议只生成一次性钱包使用）
2. **高安全标准版本** (`crypto_wallet_secure_optimized.py`) - 提供多源熵、内存安全处理、SLIP-39分割备份等高级安全特性

## 快速启动

为了方便不同平台的用户使用，我们提供了针对Windows和Mac的专用启动脚本，即使是小白用户也可以轻松使用：

### Windows用户

有两种方式启动程序：

1. **批处理方式**：直接双击运行 `run_wallet_generator_windows.bat` 文件即可启动程序。

2. **PowerShell方式**（推荐）：右键点击 `run_wallet_generator.ps1` 文件，选择"使用PowerShell运行"。
   - 如果遇到安全策略限制，可以在PowerShell中执行以下命令：
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process
   .\run_wallet_generator.ps1
   ```

如果遇到依赖库问题，可以使用专门的依赖安装脚本：
```powershell
.\install_dependencies.ps1
```

### Mac用户

直接双击运行 `run_wallet_generator_mac.command` 文件即可启动程序。

如果首次运行提示没有权限，请在终端中执行以下命令：
```bash
chmod +x run_wallet_generator_mac.command
```

### Linux用户

使用以下命令运行启动脚本：
```bash
chmod +x run_wallet_generator.sh
./run_wallet_generator.sh
```

### 功能说明

所有平台的启动脚本都提供以下功能：

1. 自动检查Python环境和依赖库
2. 提供简单的菜单系统，可以选择：
   - 基础版本 - 简单的命令行工具（建议只生成一次性钱包使用）
   - 高安全标准版本 - 提供高级安全特性
   - 安装依赖 - 安装运行工具所需的依赖库

启动脚本会自动检查环境和依赖，并提供友好的用户界面，非常适合不熟悉命令行的用户。

## 安全特性

- **多源熵收集**：结合操作系统CSPRNG、硬件随机源、计算熵和用户输入
- **内存安全处理**：敏感数据使用后立即从内存中安全清除
- **Unicode规范化**：严格遵循BIP-39标准的NFKD规范化
- **SLIP-39分割备份**：支持Shamir秘密共享方案，防止单点故障
- **全面安全提示**：提供详细的安全建议和用户教育
- **系统安全检查**：检测运行环境的安全状态
- **离线使用支持**：推荐并支持在离线环境中使用
- **密码强度检查**：评估密码短语的强度并提供改进建议
- **钱包地址生成**：从助记词生成常见加密货币的钱包地址
- **配置文件支持**：允许用户自定义设置和偏好
- **备份提醒机制**：定期提醒用户验证备份，确保资产安全

## 安装

1. 确保已安装Python 3.7+
2. 安装依赖库：

```bash
# 基础版本
pip install -r requirements.txt

# 高安全标准版本（包含SLIP-39支持）
pip install -r requirements_secure.txt

# 安装额外功能的依赖（钱包地址生成等）
pip install hdwallet base58 bech32 ecdsa
```

## 使用方法

### 基础版本

```bash
python crypto_wallet_generator.py generate  # 生成助记词
python crypto_wallet_generator.py verify "your mnemonic words here"  # 验证助记词
```

### 高安全标准版本

```bash
python crypto_wallet_secure_optimized.py
```

通过交互式菜单选择功能：
1. 生成新的钱包助记词
2. 验证助记词是否有效
3. 生成SLIP-39分割备份
4. 恢复SLIP-39分割备份
5. 检查系统安全状态

### SLIP-39分割备份详细说明

SLIP-39（Shamir's Secret Sharing for Mnemonic Codes）是一种高级备份方法，允许您将助记词分割成多个部分，并且只需要部分碎片就能恢复完整的助记词。这种方法基于Shamir的秘密共享算法，提供了额外的安全性和冗余性。

#### 生成SLIP-39分割备份

1. **启动程序并选择功能**：
   ```bash
   python crypto_wallet_secure_optimized.py
   ```
   在主菜单中选择 `3. 生成SLIP-39分割备份`

2. **选择助记词来源**：
   - 可以输入现有的BIP-39助记词进行分割
   - 或者生成新的助记词并分割

3. **配置分组结构**：
   - **组数**：设置要创建的组数（1-16）
   - **恢复所需组数**：设置恢复时需要的最少组数
   - 对于每个组：
     - **成员数**：设置该组的成员数（1-16）
     - **阈值**：设置该组恢复所需的最少成员数
     - 注意：当成员数大于1时，阈值不能为1（SLIP-39规范限制）

4. **设置SLIP-39密码短语（可选）**：
   - 可以为SLIP-39分享设置额外的密码短语
   - 此密码短语与BIP-39密码短语不同
   - 恢复时需要提供相同的密码短语

5. **记录分享**：
   - 程序会生成并显示所有分享
   - 每个分享都是一组英文单词
   - 将每个分享安全地记录并分别保存

#### 恢复SLIP-39分割备份

1. **启动程序并选择功能**：
   ```bash
   python crypto_wallet_secure_optimized.py
   ```
   在主菜单中选择 `4. 恢复SLIP-39分割备份`

2. **输入分享**：
   - 程序会提示您输入分享
   - 输入一个分享后，程序会自动识别其组ID和成员ID
   - 继续输入更多分享，直到达到恢复所需的数量
   - 输入空行结束输入

3. **输入SLIP-39密码短语（如果有）**：
   - 如果创建分享时使用了密码短语，需要输入相同的密码短语

4. **恢复结果**：
   - 如果提供的分享足够且正确，程序会恢复并显示原始的BIP-39助记词
   - 您可以使用这个助记词恢复您的钱包

#### SLIP-39分割备份的使用场景

SLIP-39分割备份特别适用于以下场景：

1. **家庭资产保护**：
   - 创建一个需要2个组中的分享才能恢复的方案
   - 第一组：给家庭成员（配偶、子女），设置2-of-3阈值
   - 第二组：给可信赖的朋友或律师，设置2-of-3阈值
   - 这样即使家庭成员或朋友组中有人丢失分享，仍然可以恢复钱包

2. **企业多签名钱包备份**：
   - 创建一个需要2个组中的分享才能恢复的方案
   - 第一组：给公司管理层，设置3-of-5阈值
   - 第二组：给董事会成员，设置2-of-3阈值
   - 确保公司资金需要多方授权才能访问

3. **地理分散存储**：
   - 创建一个需要3个组中的分享才能恢复的方案
   - 将不同组的分享存储在不同的地理位置（如不同城市的保险箱）
   - 即使一个位置发生自然灾害或被盗，仍然可以恢复钱包

4. **遗产规划**：
   - 创建一个需要2个组中的分享才能恢复的方案
   - 第一组：自己保管，设置1-of-1阈值
   - 第二组：分给多个继承人，设置所有人都需要合作的阈值
   - 确保只有在所有继承人合作的情况下才能访问资产

5. **紧急恢复方案**：
   - 创建一个需要任意1个组中的分享就能恢复的方案
   - 每个组设置不同的阈值和成员
   - 提供多种恢复路径，增加系统的可用性

使用SLIP-39时的最佳实践：

- **记录恢复要求**：清楚记录恢复所需的组数和每个组所需的成员数
- **测试恢复过程**：在依赖此备份前，先测试恢复过程是否正常工作
- **安全存储分享**：使用防水、防火的材料记录分享，如金属板
- **定期验证**：定期检查分享是否仍然可读和有效
- **考虑可访问性**：确保在紧急情况下，授权人员知道如何访问和使用分享

## 安全建议

### 生成助记词

- 在离线环境中生成重要钱包的助记词
- 使用24个词(256位熵)获得最高安全性
- 确保环境无摄像头、无屏幕录制、无恶意软件

### 保存助记词

- 永远不要将助记词存储在数字设备上（电脑、手机、云端）
- 将助记词写在纸上或金属板上（防火、防水）
- 存放在安全的物理位置，如保险箱
- 考虑使用SLIP-39分割备份，分散存储在不同安全位置

### 关于密码短语（第25个词）

BIP-39标准允许使用可选的密码短语（passphrase），也被称为"第25个词"，它具有以下特点：

1. **工作原理**：
   - 密码短语与助记词一起用于生成种子
   - 相同的助记词配合不同的密码短语会生成完全不同的钱包
   - 它不是助记词的一部分，而是一个额外的安全层

2. **安全优势**：
   - 即使攻击者获得了您的助记词，没有密码短语也无法访问您的资产
   - 可以创建"诱饵钱包"（使用同一助记词但不同密码短语）
   - 增加了暴力破解的难度

3. **风险与注意事项**：
   - 如果忘记密码短语，即使有助记词也**无法恢复**您的资产
   - 没有"找回密码"或"重置"功能
   - 密码短语区分大小写，包括空格和特殊字符

4. **使用建议**：
   - 对于普通用户：如果不确定是否能安全记住，建议**不使用**密码短语
   - 对于高价值钱包：考虑使用密码短语，但必须有可靠的保存方式
   - 密码短语应与助记词分开存储，使用不同的安全方法
   - 考虑使用密码管理器或其他安全工具保存密码短语

5. **最佳实践**：
   - 使用足够强度的密码短语（如果决定使用）
   - 定期测试恢复过程，确保能正确输入密码短语
   - 考虑告知受信任的家人或律师如何在紧急情况下访问您的密码短语

## 技术细节

### BIP-39实现

该工具严格遵循BIP-39标准：
- 使用128-256位熵生成12-24个助记词
- 计算SHA-256校验和并添加到熵中
- 将熵分割为11位段并映射到词表
- 使用PBKDF2-HMAC-SHA512(2048次迭代)生成种子

### 熵收集

工具从多个来源收集熵：
- 操作系统CSPRNG (os.urandom)
- Python的secrets模块
- 硬件随机源（如果可用）
- 计算熵（RSA密钥生成）
- 用户输入熵（可选）

### 数据处理与内存安全

本工具采用多种技术确保敏感数据的安全处理：

1. **零存储原则**：
   - 助记词和种子仅在内存中临时存在，不会写入磁盘
   - 不创建任何日志文件或临时文件
   - 不使用任何远程服务或API

2. **内存安全清除**：
   - 使用安全的内存覆写技术，而非简单的变量赋值
   - 敏感数据使用后立即调用专用函数进行内存清除
   - 对Python字符串、字节数组和列表等数据结构进行特殊处理

3. **内存清除实现原理**：
   - 对于字符串和字节类型：先覆写为随机数据，再覆写为零值
   - 对于列表类型：递归清除每个元素，然后清空列表
   - 强制调用Python垃圾回收器确保内存立即释放
   - 使用ctypes直接操作内存，确保彻底清除

4. **程序退出时的安全措施**：
   - 捕获所有可能的退出信号（包括正常退出和异常退出）
   - 在退出前执行全面的内存清理操作
   - 使用信号处理器确保即使在意外终止时也能清理内存

## 贡献

欢迎提交问题和拉取请求。在提交拉取请求之前，请确保您的代码符合项目的安全标准。

## 许可证

本项目采用MIT许可证 - 详见 [LICENSE](LICENSE) 文件。

## 免责声明

本工具仅供教育和研究目的使用。用户应自行承担使用风险，作者不对因使用本工具而导致的任何损失负责。在生产环境中使用前，建议进行独立的安全审计。